#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <assert.h>
#include <unistd.h>   
#include <fcntl.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <math.h>

#include "add_oof_noise.h"
#include "stim_tools.h"
#include <fftw3.h>

float OOF_HARM_AMP[54][20];
float CORR_OOF_HARM_AMP[54];


int add_oof_noise( stimParameters *stimPar, PIOFLOAT *signal) {

  long  i,j, ring;
  BRIMO *brimo = &stimPar->brimo;

  // original oof amplitudes were computed with KCMB2WATT, which may not be the calibration factor used in this sim
  double calib = brimo->KCMB2WATT / stimPar->calib;
  if (stimPar->Param.do_calibrate == -1.0) {
    // simulation is in KCMB,
    // OOF parameters are in Watts, must be multiplied by the following factor
    calib /= stimPar->calib;
  }

  // process parameters
  double amp_in_harm = 0;
  amp_in_harm = (brimo->NET*brimo->KCMB2WATT)/2/(90.)/pow(brimo->oof_fknee,brimo->oof_slope)*CORR_OOF_HARM_AMP[BC2IDX(brimo->bc)];

  STIM_TRACE( 1, "adding oof noise (%g) to rings %d-%d", 
                 amp_in_harm, stimPar->BeginRing, stimPar->EndRing);

  // loop on rings (use a noise seed per ring for realisation reproducibility)
  for (ring = stimPar->BeginRing; ring <= stimPar->EndRing; ring++) {
    long ring_length  = ENDRINGINDEX( ring) - BEGINRINGINDEX( ring) + 1;
    long first_sample = BEGINRINGINDEX( ring) - stimPar->signal_first_sample_number;
    
    // Compute the large scale noise
    int largescale=pow(2,1 + (int) (log(ring_length/180+10)/log(2)));

    fftw_complex  *in_fft = NULL;
    fftw_complex  *out_fft = NULL;

    fftw_plan     p1 = NULL, p2 = NULL;
    in_fft  = (fftw_complex*) fftw_malloc(sizeof(fftw_complex) * largescale);
    out_fft = (fftw_complex*) fftw_malloc(sizeof(fftw_complex) * largescale);

    PIODOUBLE *tpin   = (PIODOUBLE *) in_fft;
    PIODOUBLE *tpout  = (PIODOUBLE *) out_fft;

    p1 = fftw_plan_dft_1d( largescale, in_fft, out_fft, FFTW_FORWARD, FFTW_ESTIMATE );
    p2 = fftw_plan_dft_1d( largescale, in_fft, out_fft, FFTW_BACKWARD, FFTW_ESTIMATE );

    // build white noise TOI
    for (j=0;j<largescale;j++) {
      tpin[2*j]   = whitenoise( stimPar, ring) * amp_in_harm;
      tpin[2*j+1] = 0;
    }
    fftw_execute(p1);
    
    // convolve (multiply in frequency domain) white noise TOI with noise Fourier transform
    tpin[0]=0;
    tpin[1]=0;

    for (j=1;j<largescale;j++) {
      double l_tmp=pow((double) j,brimo->oof_slope);
      tpin[2*j]=tpout[2*j]*l_tmp;
      tpin[2*j+1]=tpout[2*j+1]*l_tmp;
    }
    fftw_execute(p2);

    // add oof noise
    for (i = 0; i < ring_length; i++) {
      signal[first_sample + i] += ((tpout[2*(i/180)]*(180-(i%180))+tpout[2*((i/180)+1)]*((i%180)))/180.) * calib;
    }

    fftw_free(in_fft);
    fftw_free(out_fft);
    fftw_destroy_plan( p1);
    fftw_destroy_plan( p2);
  }
  fftw_cleanup();
  return( 0);
}

////////////////////////////////////////////////////////////////////////////////
// inline amplitude values for one over f noise harmonics per bolometer

#if 0
# python code to generate the OOF_HARM_AMP array from data files
import numpy
from IMO_4_27 import *
print "float OOF_HARM_AMP[54][20] = {"
for idx in range(54):
  boloid = BC2BOLOID(IDX2BC(idx))
  pixname = boloid[3:].replace("_","-")
  try:
    oofdat = numpy.fromfile("/pscratch1/RD12_data/dmc/MISS03/DATA/oof_noise_JUL16/%s_oof.dat"%pixname, dtype="float32")
    assert len(oofdat) == 20
  except:
    oofdat = numpy.zeros(20)
  print "/* %s */ {" % boloid,
  for a in oofdat[:-1]: print "%g,"%a,
  if idx < 53:
    print "%g },"%oofdat[-1]
  else:
    print "%g }};"%oofdat[-1]
#endif


float OOF_HARM_AMP[54][20] = {
/* 00_100_1a */ { 9.66949e-19, 7.10277e-19, 5.93004e-19, 5.21738e-19, 4.72413e-19, 4.35594e-19, 4.06712e-19, 3.83245e-19, 3.63673e-19, 3.47013e-19, 3.32602e-19, 3.19968e-19, 3.0877e-19, 2.98752e-19, 2.89718e-19, 2.81515e-19, 2.74021e-19, 2.67138e-19, 2.60786e-19, 2.54901e-19 },
/* 01_100_1b */ { 9.45101e-19, 6.69159e-19, 5.46783e-19, 4.73784e-19, 4.23943e-19, 3.87138e-19, 3.58524e-19, 3.35453e-19, 3.16338e-19, 3.00164e-19, 2.86247e-19, 2.74105e-19, 2.63391e-19, 2.53846e-19, 2.4527e-19, 2.37511e-19, 2.30445e-19, 2.23977e-19, 2.18025e-19, 2.12525e-19 },
/* 02_143_1a */ { 9.46547e-19, 6.16859e-19, 4.80185e-19, 4.02004e-19, 3.5024e-19, 3.12934e-19, 2.8451e-19, 2.61983e-19, 2.43599e-19, 2.28249e-19, 2.15199e-19, 2.03937e-19, 1.94099e-19, 1.85413e-19, 1.77677e-19, 1.70733e-19, 1.64457e-19, 1.58752e-19, 1.53537e-19, 1.48749e-19 },
/* 03_143_1b */ { 1.0142e-18, 7.0211e-19, 5.66207e-19, 4.86056e-19, 4.31786e-19, 3.91973e-19, 3.6119e-19, 3.36486e-19, 3.16102e-19, 2.98916e-19, 2.84176e-19, 2.71355e-19, 2.60072e-19, 2.50044e-19, 2.41057e-19, 2.32942e-19, 2.25569e-19, 2.1883e-19, 2.12642e-19, 2.06933e-19 },
/* 04_217_1 */  { 1.92428e-18, 1.36465e-18, 1.11614e-18, 9.67781e-19, 8.66424e-19, 7.91542e-19, 7.33302e-19, 6.86328e-19, 6.47397e-19, 6.14448e-19, 5.86089e-19, 5.61343e-19, 5.39503e-19, 5.20041e-19, 5.02553e-19, 4.86728e-19, 4.72316e-19, 4.59119e-19, 4.46976e-19, 4.35752e-19 },
/* 05_353_1 */  { 9.97456e-19, 6.53664e-19, 5.10494e-19, 4.28366e-19, 3.73877e-19, 3.34543e-19, 3.04533e-19, 2.80722e-19, 2.61269e-19, 2.45013e-19, 2.31181e-19, 2.19236e-19, 2.08794e-19, 1.9957e-19, 1.91349e-19, 1.83966e-19, 1.7729e-19, 1.71218e-19, 1.65665e-19, 1.60565e-19 },
/* 10_143_5 */  { 1.24043e-18, 8.26556e-19, 6.51845e-19, 5.50774e-19, 4.83302e-19, 4.34356e-19, 3.96861e-19, 3.67008e-19, 3.42545e-19, 3.22047e-19, 3.04564e-19, 2.89432e-19, 2.76178e-19, 2.64448e-19, 2.53976e-19, 2.44555e-19, 2.36025e-19, 2.28254e-19, 2.2114e-19, 2.14596e-19 },
/* 11_217_5a */ { 1.07452e-18, 7.21305e-19, 5.71301e-19, 4.84199e-19, 4.25892e-19, 3.83503e-19, 3.50973e-19, 3.25034e-19, 3.03749e-19, 2.85893e-19, 2.70647e-19, 2.57439e-19, 2.45858e-19, 2.35602e-19, 2.26438e-19, 2.18189e-19, 2.10714e-19, 2.03901e-19, 1.97659e-19, 1.91915e-19 },
/* 12_217_5b */ { 1.43595e-18, 1.00211e-18, 8.1195e-19, 6.99343e-19, 6.22869e-19, 5.66636e-19, 5.23071e-19, 4.88051e-19, 4.59112e-19, 4.34682e-19, 4.13705e-19, 3.95439e-19, 3.79349e-19, 3.65036e-19, 3.52197e-19, 3.40596e-19, 3.30047e-19, 3.20401e-19, 3.11536e-19, 3.03352e-19 },
/* 13_353_2 */  { 1.35632e-18, 9.61999e-19, 7.86875e-19, 6.82318e-19, 6.10885e-19, 5.58107e-19, 5.17058e-19, 4.83949e-19, 4.56508e-19, 4.33283e-19, 4.13293e-19, 3.95849e-19, 3.80454e-19, 3.66735e-19, 3.54407e-19, 3.43251e-19, 3.33091e-19, 3.23788e-19, 3.15227e-19, 3.07315e-19 },
/* 14_545_1 */  { 6.63274e-18, 4.72165e-18, 3.87039e-18, 3.36121e-18, 3.01286e-18, 2.75521e-18, 2.55465e-18, 2.39275e-18, 2.25848e-18, 2.14477e-18, 2.04684e-18, 1.96136e-18, 1.88587e-18, 1.81858e-18, 1.75809e-18, 1.70333e-18, 1.65344e-18, 1.60774e-18, 1.56568e-18, 1.5268e-18 },
/* 15_Dark1 */  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
/* 20_100_2a */ { 9.05939e-19, 6.37242e-19, 5.18711e-19, 4.4824e-19, 4.00241e-19, 3.64864e-19, 3.37404e-19, 3.15294e-19, 2.96997e-19, 2.81531e-19, 2.68236e-19, 2.56647e-19, 2.46429e-19, 2.37332e-19, 2.29165e-19, 2.21779e-19, 2.15059e-19, 2.08909e-19, 2.03254e-19, 1.98031e-19 },
/* 21_100_2b */ { 9.37497e-19, 6.46388e-19, 5.20039e-19, 4.45673e-19, 3.95397e-19, 3.58558e-19, 3.30102e-19, 3.07284e-19, 2.8847e-19, 2.72619e-19, 2.59032e-19, 2.47219e-19, 2.36829e-19, 2.27599e-19, 2.1933e-19, 2.11867e-19, 2.05088e-19, 1.98895e-19, 1.9321e-19, 1.87966e-19 },
/* 22_217_2 */  { 2.09305e-18, 1.4998e-18, 1.23413e-18, 1.0747e-18, 9.6536e-19, 8.84334e-19, 8.21156e-19, 7.70089e-19, 7.27687e-19, 6.9174e-19, 6.60754e-19, 6.3368e-19, 6.09754e-19, 5.88409e-19, 5.69209e-19, 5.51816e-19, 5.35963e-19, 5.21433e-19, 5.08052e-19, 4.95675e-19 },
/* 23_353_3a */ { 1.26696e-18, 8.59984e-19, 6.85579e-19, 5.83738e-19, 5.15283e-19, 4.65355e-19, 4.26935e-19, 3.96228e-19, 3.70981e-19, 3.49763e-19, 3.31616e-19, 3.15873e-19, 3.02051e-19, 2.89794e-19, 2.78831e-19, 2.68951e-19, 2.59989e-19, 2.51814e-19, 2.44317e-19, 2.37411e-19 },
/* 24_353_3b */ { 1.23863e-18, 8.87531e-19, 7.30307e-19, 6.35953e-19, 5.71246e-19, 5.23296e-19, 4.85908e-19, 4.55687e-19, 4.30595e-19, 4.09322e-19, 3.90985e-19, 3.74963e-19, 3.60805e-19, 3.48173e-19, 3.36812e-19, 3.26519e-19, 3.17138e-19, 3.08539e-19, 3.00621e-19, 2.93296e-19 },
/* 25_857_1 */  { 5.5025e-18, 3.78741e-18, 3.04405e-18, 2.60691e-18, 2.31155e-18, 2.09524e-18, 1.92823e-18, 1.79435e-18, 1.68401e-18, 1.59106e-18, 1.5114e-18, 1.44217e-18, 1.38129e-18, 1.32722e-18, 1.27878e-18, 1.23507e-18, 1.19537e-18, 1.15911e-18, 1.12583e-18, 1.09514e-18 },
/* 30_143_2a */ { 1.08816e-18, 7.34256e-19, 5.83324e-19, 4.95454e-19, 4.3652e-19, 3.9361e-19, 3.60638e-19, 3.34318e-19, 3.12701e-19, 2.94551e-19, 2.79042e-19, 2.65597e-19, 2.53801e-19, 2.43348e-19, 2.34004e-19, 2.25588e-19, 2.17958e-19, 2.11001e-19, 2.04625e-19, 1.98754e-19 },
/* 31_143_2b */ { 1.04396e-18, 6.82732e-19, 5.32555e-19, 4.46497e-19, 3.89443e-19, 3.48283e-19, 3.16895e-19, 2.92002e-19, 2.71673e-19, 2.5469e-19, 2.40244e-19, 2.27772e-19, 2.16871e-19, 2.07245e-19, 1.98667e-19, 1.90965e-19, 1.84002e-19, 1.7767e-19, 1.71881e-19, 1.66563e-19 },
/* 32_353_4a */ { 9.91752e-19, 6.79998e-19, 5.45299e-19, 4.66242e-19, 4.12904e-19, 3.73886e-19, 3.43787e-19, 3.19681e-19, 2.99824e-19, 2.83109e-19, 2.68793e-19, 2.56356e-19, 2.45424e-19, 2.35719e-19, 2.27029e-19, 2.1919e-19, 2.12073e-19, 2.05575e-19, 1.99612e-19, 1.94114e-19 },
/* 33_353_4b */ { 1.08032e-18, 7.45826e-19, 6.00493e-19, 5.14899e-19, 4.57002e-19, 4.14564e-19, 3.81773e-19, 3.55472e-19, 3.33781e-19, 3.15502e-19, 2.9983e-19, 2.86204e-19, 2.74217e-19, 2.63566e-19, 2.54023e-19, 2.45409e-19, 2.37583e-19, 2.30434e-19, 2.23869e-19, 2.17814e-19 },
/* 34_545_2 */  { 6.19858e-18, 4.572e-18, 3.82633e-18, 3.37225e-18, 3.0575e-18, 2.82226e-18, 2.63754e-18, 2.48734e-18, 2.36196e-18, 2.25517e-18, 2.16274e-18, 2.08166e-18, 2.00977e-18, 1.94542e-18, 1.88737e-18, 1.83463e-18, 1.78643e-18, 1.74215e-18, 1.70128e-18, 1.66339e-18 },
/* 35_857_2 */  { 7.55189e-18, 5.45953e-18, 4.51579e-18, 3.94688e-18, 3.55545e-18, 3.26462e-18, 3.03737e-18, 2.85334e-18, 2.70029e-18, 2.57036e-18, 2.45821e-18, 2.36011e-18, 2.27332e-18, 2.19582e-18, 2.12604e-18, 2.06278e-18, 2.00507e-18, 1.95214e-18, 1.90335e-18, 1.8582e-18 },
/* 40_100_3a */ { 9.85496e-19, 7.02063e-19, 5.75736e-19, 5.00146e-19, 4.48419e-19, 4.10152e-19, 3.80356e-19, 3.56302e-19, 3.3635e-19, 3.19452e-19, 3.04897e-19, 2.9219e-19, 2.80969e-19, 2.70964e-19, 2.6197e-19, 2.53828e-19, 2.4641e-19, 2.39614e-19, 2.33359e-19, 2.27576e-19 },
/* 41_100_3b */ { 9.35882e-19, 6.60029e-19, 5.38082e-19, 4.65484e-19, 4.15989e-19, 3.79481e-19, 3.51126e-19, 3.28282e-19, 3.09368e-19, 2.93375e-19, 2.79621e-19, 2.67628e-19, 2.57051e-19, 2.47631e-19, 2.39171e-19, 2.3152e-19, 2.24556e-19, 2.18182e-19, 2.12319e-19, 2.06902e-19 },
/* 42_143_6 */  { 1.50384e-18, 1.08124e-18, 8.91472e-19, 7.77394e-19, 6.99061e-19, 6.40954e-19, 5.95611e-19, 5.58934e-19, 5.28461e-19, 5.02614e-19, 4.80322e-19, 4.60836e-19, 4.43609e-19, 4.28235e-19, 4.14401e-19, 4.01864e-19, 3.90434e-19, 3.79955e-19, 3.70302e-19, 3.61371e-19 },
/* 43_217_6a */ { 9.26286e-19, 6.36531e-19, 5.1111e-19, 4.37415e-19, 3.87653e-19, 3.51227e-19, 3.23113e-19, 3.00586e-19, 2.82022e-19, 2.6639e-19, 2.52997e-19, 2.41359e-19, 2.31126e-19, 2.22039e-19, 2.13901e-19, 2.06558e-19, 1.99891e-19, 1.93802e-19, 1.88213e-19, 1.83059e-19 },
/* 44_217_6b */ { 8.94375e-19, 5.86365e-19, 4.58052e-19, 3.84429e-19, 3.35576e-19, 3.00305e-19, 2.73393e-19, 2.52037e-19, 2.3459e-19, 2.20008e-19, 2.076e-19, 1.96884e-19, 1.87516e-19, 1.7924e-19, 1.71864e-19, 1.65239e-19, 1.59249e-19, 1.538e-19, 1.48818e-19, 1.44241e-19 },
/* 45_353_7 */  { 1.98939e-18, 1.41031e-18, 1.15323e-18, 9.99788e-19, 8.94973e-19, 8.17543e-19, 7.57328e-19, 7.08764e-19, 6.68519e-19, 6.34458e-19, 6.05145e-19, 5.79568e-19, 5.56995e-19, 5.3688e-19, 5.18807e-19, 5.02452e-19, 4.87559e-19, 4.73922e-19, 4.61374e-19, 4.49776e-19 },
/* 50_143_3a */ { 1.56137e-18, 1.15827e-18, 9.72616e-19, 8.59236e-19, 7.80476e-19, 7.21515e-19, 6.75152e-19, 6.37407e-19, 6.05868e-19, 5.7898e-19, 5.55687e-19, 5.35241e-19, 5.17097e-19, 5.00848e-19, 4.86179e-19, 4.72847e-19, 4.60656e-19, 4.49451e-19, 4.39102e-19, 4.29504e-19 },
/* 51_143_3b */ { 1.24815e-18, 9.06579e-19, 7.51928e-19, 6.58481e-19, 5.94072e-19, 5.46152e-19, 5.08665e-19, 4.78278e-19, 4.52986e-19, 4.31496e-19, 4.12936e-19, 3.9669e-19, 3.8231e-19, 3.69462e-19, 3.57889e-19, 3.47391e-19, 3.3781e-19, 3.2902e-19, 3.20915e-19, 3.13411e-19 },
/* 52_217_3 */  { 1.78455e-18, 1.26848e-18, 1.03888e-18, 9.01647e-19, 8.07815e-19, 7.38445e-19, 6.84462e-19, 6.409e-19, 6.04783e-19, 5.74203e-19, 5.47875e-19, 5.24894e-19, 5.04607e-19, 4.86523e-19, 4.7027e-19, 4.55559e-19, 4.42159e-19, 4.29886e-19, 4.18591e-19, 4.0815e-19 },
/* 53_353_5a */ { 1.01919e-18, 7.02867e-19, 5.65549e-19, 4.84719e-19, 4.30067e-19, 3.9002e-19, 3.59084e-19, 3.34277e-19, 3.13822e-19, 2.96588e-19, 2.81814e-19, 2.6897e-19, 2.57672e-19, 2.47636e-19, 2.38644e-19, 2.30528e-19, 2.23156e-19, 2.16422e-19, 2.10239e-19, 2.04536e-19 },
/* 54_353_5b */ { 1.29333e-18, 9.19946e-19, 7.53737e-19, 6.5436e-19, 5.86393e-19, 5.36135e-19, 4.97018e-19, 4.65448e-19, 4.3927e-19, 4.17103e-19, 3.98016e-19, 3.81354e-19, 3.66644e-19, 3.5353e-19, 3.41744e-19, 3.31074e-19, 3.21355e-19, 3.12454e-19, 3.04261e-19, 2.96686e-19 },
/* 55_545_3 */  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
/* 60_143_7 */  { 1.40362e-18, 9.66321e-19, 7.76752e-19, 6.65263e-19, 5.89929e-19, 5.34755e-19, 4.92151e-19, 4.58e-19, 4.29849e-19, 4.06136e-19, 3.85815e-19, 3.68152e-19, 3.52618e-19, 3.38821e-19, 3.26462e-19, 3.1531e-19, 3.05181e-19, 2.95929e-19, 2.87436e-19, 2.79604e-19 },
/* 61_217_7a */ { 1.0223e-18, 7.10286e-19, 5.74015e-19, 4.935e-19, 4.3891e-19, 3.98821e-19, 3.67796e-19, 3.42879e-19, 3.22306e-19, 3.04951e-19, 2.90057e-19, 2.77097e-19, 2.65686e-19, 2.55541e-19, 2.46445e-19, 2.38229e-19, 2.30761e-19, 2.23935e-19, 2.17664e-19, 2.11877e-19 },
/* 62_217_7b */ { 1.01563e-18, 6.62929e-19, 5.16527e-19, 4.32714e-19, 3.77188e-19, 3.37153e-19, 3.06637e-19, 2.82445e-19, 2.62696e-19, 2.46202e-19, 2.32176e-19, 2.2007e-19, 2.09492e-19, 2.00151e-19, 1.91831e-19, 1.84361e-19, 1.77609e-19, 1.71469e-19, 1.65858e-19, 1.60704e-19 },
/* 63_353_6a */ { 1.66536e-18, 1.13528e-18, 9.07329e-19, 7.73929e-19, 6.84118e-19, 6.18531e-19, 5.68008e-19, 5.27591e-19, 4.94335e-19, 4.66367e-19, 4.42432e-19, 4.21656e-19, 4.03406e-19, 3.87214e-19, 3.72724e-19, 3.59662e-19, 3.47808e-19, 3.36991e-19, 3.27068e-19, 3.17925e-19 },
/* 64_353_6b */ { 1.47508e-18, 9.51389e-19, 7.36117e-19, 6.1362e-19, 5.32826e-19, 4.74776e-19, 4.30657e-19, 3.95768e-19, 3.67348e-19, 3.43658e-19, 3.23548e-19, 3.06217e-19, 2.91096e-19, 2.77762e-19, 2.65898e-19, 2.5526e-19, 2.45654e-19, 2.36929e-19, 2.28961e-19, 2.2165e-19 },
/* 65_857_3 */  { 5.38815e-18, 3.89047e-18, 3.21563e-18, 2.80908e-18, 2.52948e-18, 2.32182e-18, 2.15961e-18, 2.02828e-18, 1.91908e-18, 1.82639e-18, 1.74641e-18, 1.67645e-18, 1.61458e-18, 1.55933e-18, 1.50959e-18, 1.4645e-18, 1.42337e-18, 1.38566e-18, 1.3509e-18, 1.31873e-18 },
/* 70_143_8 */  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
/* 71_217_8a */ { 1.11897e-18, 7.46459e-19, 5.89063e-19, 4.97958e-19, 4.37113e-19, 3.92961e-19, 3.59128e-19, 3.32185e-19, 3.10102e-19, 2.91596e-19, 2.75808e-19, 2.62142e-19, 2.50169e-19, 2.39572e-19, 2.30111e-19, 2.21599e-19, 2.1389e-19, 2.06868e-19, 2.00437e-19, 1.94522e-19 },
/* 72_217_8b */ { 1.31541e-18, 9.42089e-19, 7.74979e-19, 6.74717e-19, 6.05971e-19, 5.55034e-19, 5.15323e-19, 4.83227e-19, 4.56581e-19, 4.33992e-19, 4.14522e-19, 3.97511e-19, 3.8248e-19, 3.6907e-19, 3.57009e-19, 3.46084e-19, 3.36126e-19, 3.26999e-19, 3.18595e-19, 3.10822e-19 },
/* 73_545_4 */  { 4.59173e-18, 3.00391e-18, 2.34361e-18, 1.96516e-18, 1.71424e-18, 1.53319e-18, 1.39512e-18, 1.28561e-18, 1.19618e-18, 1.12146e-18, 1.05789e-18, 1.00302e-18, 9.55053e-19, 9.12692e-19, 8.74945e-19, 8.4105e-19, 8.10408e-19, 7.8254e-19, 7.57062e-19, 7.33659e-19 },
/* 74_857_4 */  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
/* 75_Dark2 */  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
/* 80_100_4a */ { 7.95177e-19, 5.52811e-19, 4.46908e-19, 3.84317e-19, 3.4187e-19, 3.10693e-19, 2.86561e-19, 2.67179e-19, 2.51173e-19, 2.37669e-19, 2.2608e-19, 2.15995e-19, 2.07115e-19, 1.99219e-19, 1.92139e-19, 1.85744e-19, 1.79931e-19, 1.74616e-19, 1.69734e-19, 1.65229e-19 },
/* 81_100_4b */ { 9.84481e-19, 7.27988e-19, 6.10162e-19, 5.38321e-19, 4.88474e-19, 4.51193e-19, 4.21901e-19, 3.98069e-19, 3.78167e-19, 3.61209e-19, 3.46525e-19, 3.33641e-19, 3.22212e-19, 3.1198e-19, 3.02747e-19, 2.94357e-19, 2.86688e-19, 2.79641e-19, 2.73134e-19, 2.67101e-19 },
/* 82_143_4a */ { 1.36728e-18, 9.0032e-19, 7.05096e-19, 5.92836e-19, 5.18223e-19, 4.64287e-19, 4.23088e-19, 3.90367e-19, 3.63612e-19, 3.41236e-19, 3.22184e-19, 3.0572e-19, 2.9132e-19, 2.78592e-19, 2.67243e-19, 2.57046e-19, 2.47822e-19, 2.39429e-19, 2.31751e-19, 2.24695e-19 },
/* 83_143_4b */ { 1.24366e-18, 8.28004e-19, 6.52661e-19, 5.51268e-19, 4.83602e-19, 4.34528e-19, 3.96943e-19, 3.67023e-19, 3.42509e-19, 3.21972e-19, 3.04457e-19, 2.893e-19, 2.76024e-19, 2.64276e-19, 2.53789e-19, 2.44356e-19, 2.35815e-19, 2.28036e-19, 2.20913e-19, 2.14362e-19 },
/* 84_217_4 */  { 1.8054e-18, 1.23929e-18, 9.94465e-19, 8.50691e-19, 7.53648e-19, 6.82635e-19, 6.2784e-19, 5.83944e-19, 5.47778e-19, 5.1733e-19, 4.91246e-19, 4.68584e-19, 4.48661e-19, 4.30971e-19, 4.1513e-19, 4.00839e-19, 3.87863e-19, 3.76014e-19, 3.65139e-19, 3.55113e-19 },
/* 85_353_8 */  { 1.55744e-18, 1.03712e-18, 8.17594e-19, 6.90637e-19, 6.05904e-19, 5.44448e-19, 4.97378e-19, 4.59906e-19, 4.29204e-19, 4.03481e-19, 3.81542e-19, 3.62557e-19, 3.45927e-19, 3.31212e-19, 3.18075e-19, 3.06258e-19, 2.95559e-19, 2.85813e-19, 2.76891e-19, 2.68684e-19 }};

float CORR_OOF_HARM_AMP[54] = {
/* 00_100_1a */  0.50,   //OK
/* 01_100_1b */  2.10,   //OK
/* 02_143_1a */  0.84,   //OK
/* 03_143_1b */  1.07,   //OK
/* 04_217_1 */   1.90,   //OK
/* 05_353_1 */   0.500,  //OK
/* 10_143_5 */   1.047,  //OK
/* 11_217_5a */  1.074,  //OK
/* 12_217_5b */  1.55,   //OK
/* 13_353_2 */   0.45,   //OK
/* 14_545_1 */   1.0,
/* 15_Dark1 */   1.0,
/* 20_100_2a */  0.6,    //OK
/* 21_100_2b */  1.0,    //OK
/* 22_217_2 */   3.50,   //OK
/* 23_353_3a */  1.186,  //OK
/* 24_353_3b */  1.058,  //OK
/* 25_857_1 */   1.0,
/* 30_143_2a */  0.986,  //OK
/* 31_143_2b */  0.959,  //OK
/* 32_353_4a */  0.932,  //OK
/* 33_353_4b */  1.25,   //OK
/* 34_545_2 */   1.0,
/* 35_857_2 */   1.0,
/* 40_100_3a */  1.02,   //OK
/* 41_100_3b */  1.077,  //OK
/* 42_143_6 */   1.15,   //OK
/* 43_217_6a */  1.40,   //OK
/* 44_217_6b */  1.40,   //OK
/* 45_353_7 */   2.20,   //OK
/* 50_143_3a */  1.20,   //OK
/* 51_143_3b */  2.00,   //OK
/* 52_217_3 */   3.80,   //OK
/* 53_353_5a */  0.92,   //OK
/* 54_353_5b */  1.11,   //OK
/* 55_545_3 */   1.0,
/* 60_143_7 */   1.70,   //OK
/* 61_217_7a */  0.758,  //OK
/* 62_217_7b */  0.98,   //OK
/* 63_353_6a */  3.5,    //OK
/* 64_353_6b */  2.6,    //OK
/* 65_857_3 */   1.0,
/* 70_143_8 */   1.0,
/* 71_217_8a */  1.0,    //OK
/* 72_217_8b */  1.08,   //OK
/* 73_545_4 */   1.0,
/* 74_857_4 */   1.0,
/* 75_Dark2 */   1.0,
/* 80_100_4a */  0.150,  //OK
/* 81_100_4b */  1.0414, //OK
/* 82_143_4a */  1.14,   //OK
/* 83_143_4b */  1.25,   //OK
/* 84_217_4 */   1.60,   //OK
/* 85_353_8 */   3.00};  //NOK
